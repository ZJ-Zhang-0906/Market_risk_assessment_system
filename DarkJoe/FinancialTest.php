<?php
$terms = [
    "éŠ€è¡Œå€Ÿæ¬¾å°æ·¨å€¼æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºéŠ€è¡Œå€Ÿæ¬¾å°æ·¨å€¼æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:éŠ€è¡Œå€Ÿæ¬¾/æ·¨åˆ©,ç›¡é‡ç°¡çŸ­å›è¦†",
    "æ¬Šç›Šç¸½é¡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæ¬Šç›Šç¸½é¡ï¼Œä»–çš„å…¬å¼æ˜¯:å…¨éƒ¨è³‡ç”¢æ¸›å…¨éƒ¨è² å‚µå¾Œçš„å‡ˆè³‡ç”¢,ç›¡é‡ç°¡çŸ­å›è¦†",
    "é•·æœŸéŠ€è¡Œå€Ÿæ¬¾å°æ·¨å€¼æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºé•·æœŸéŠ€è¡Œå€Ÿæ¬¾å°æ·¨å€¼æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:é•·æœŸéŠ€è¡Œå€Ÿæ¬¾/æ·¨åˆ©,ç›¡é‡ç°¡çŸ­å›è¦†",
    "æ§“æ¡¿æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæ§“æ¡¿æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:è² å‚µç¸½é¡/æ·¨åˆ©,ç›¡é‡ç°¡çŸ­å›è¦†",
    "æµå‹•æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæµå‹•æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:(æµå‹•è³‡ç”¢ç¸½è¨ˆ/æµå‹•è² å‚µç¸½è¨ˆ)*100,ç›¡é‡ç°¡çŸ­å›è¦†",
    "é€Ÿå‹•æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºé€Ÿå‹•æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:(é€Ÿå‹•è³‡ç”¢ç¸½è¨ˆ/æµå‹•è² å‚µç¸½è¨ˆ)*100,ç›¡é‡ç°¡çŸ­å›è¦†",
    "å­˜è²¨é€±è½‰ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºå­˜è²¨é€±è½‰ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:ç‡Ÿæ¥­æˆæœ¬/å­˜è²¨,ç›¡é‡ç°¡çŸ­å›è¦†",
    "ç‡Ÿé‹è³‡é‡‘é€±è½‰ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºç‡Ÿé‹è³‡é‡‘é€±è½‰ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:ç‡Ÿæ¥­æ”¶å…¥/ç‡Ÿé‹è³‡é‡‘æ·¨é¡,ç›¡é‡ç°¡çŸ­å›è¦†",
    "ç´”ç›Šç‡(ç¨…å¾Œ)" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºç´”ç›Šç‡(ç¨…å¾Œ)ï¼Œä»–çš„å…¬å¼æ˜¯:ç¨…å¾Œæç›Š/ç‡Ÿæ¥­æ”¶å…¥,ç›¡é‡ç°¡çŸ­å›è¦†",
    "æ·¨å€¼å ±é…¬ç‡(ç¨…å¾Œ)" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæ·¨å€¼å ±é…¬ç‡(ç¨…å¾Œ)ï¼Œä»–çš„å…¬å¼æ˜¯:ç¨…å¾Œæç›Š/æ·¨åˆ©,ç›¡é‡ç°¡çŸ­å›è¦†",
    "ç‡Ÿæ¥­æ´»å‹•ä¹‹æ·¨ç¾é‡‘æµé‡å°çŸ­æœŸéŠ€è¡Œå€Ÿæ¬¾æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºç‡Ÿæ¥­æ´»å‹•ä¹‹æ·¨ç¾é‡‘æµé‡å°çŸ­æœŸéŠ€è¡Œå€Ÿæ¬¾æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:ç‡Ÿæ¥­æ´»å‹•ä¹‹æ·¨ç¾é‡‘æµé‡/çŸ­æœŸéŠ€è¡Œå€Ÿæ¬¾,ç›¡é‡ç°¡çŸ­å›è¦†",
    "è³‡æœ¬æ”¯å‡ºå°å›ºå®šè³‡ç”¢æ·¨é¡æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºè³‡æœ¬æ”¯å‡ºå°å›ºå®šè³‡ç”¢æ·¨é¡æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:è³‡æœ¬æ”¯å‡º/å›ºå®šè³‡ç”¢æ·¨é¡,ç›¡é‡ç°¡çŸ­å›è¦†",
    "ç¾é‡‘æµé‡æ¯”ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºç¾é‡‘æµé‡æ¯”ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:ç‡Ÿæ¥­æ´»å‹•ä¹‹æ·¨ç¾é‡‘æµé‡/æµå‹•è² å‚µç¸½è¨ˆ,ç›¡é‡ç°¡çŸ­å›è¦†",
    "å‚µæœ¬æ¯”(ä¿¡ä¿ä¹‹è² å‚µæ¯”ç‡)" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºå‚µæœ¬æ¯”(ä¿¡ä¿ä¹‹è² å‚µæ¯”ç‡)ï¼Œä»–çš„å…¬å¼æ˜¯:(è² å‚µ/æ·¨åˆ©)*100,ç›¡é‡ç°¡çŸ­å›è¦†",
    "å›ºå®šé•·æœŸé©åˆç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºå›ºå®šé•·æœŸé©åˆç‡ï¼Œä»–çš„å…¬å¼æ˜¯:((å›ºå®šè³‡ç”¢+é•·æŠ•)/(æ·¨åˆ©+é•·è² ))*100,ç›¡é‡ç°¡çŸ­å›è¦†",
    "å­˜è´§é€±è½‰å¤©æ•¸" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºå­˜è´§é€±è½‰å¤©æ•¸ï¼Œä»–çš„å…¬å¼æ˜¯:365/(éŠ·è²¨æˆæœ¬/å¹³å‡å­˜è²¨),ç›¡é‡ç°¡çŸ­å›è¦†",
    "æ‡‰æ”¶æ¬¾é€±è½‰å¤©æ•¸" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæ‡‰æ”¶æ¬¾é€±è½‰å¤©æ•¸ï¼Œä»–çš„å…¬å¼æ˜¯:365/(éŠ·è²¨æ”¶å…¥æ·¨é¡/å¹³å‡æ‡‰æ”¶å¸³æ¬¾),ç›¡é‡ç°¡çŸ­å›è¦†",
    "æ‡‰ä»˜æ¬¾é€±è½‰å¤©æ•¸" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºæ‡‰ä»˜æ¬¾é€±è½‰å¤©æ•¸ï¼Œä»–çš„å…¬å¼æ˜¯:365/(éŠ·è²¨æˆæœ¬/å¹³å‡æ‡‰ä»˜æ¬¾),ç›¡é‡ç°¡çŸ­å›è¦†",
    "ç¾é‡‘å¾ªç’°å¤©æ•¸" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºç¾é‡‘å¾ªç’°å¤©æ•¸ï¼Œä»–çš„å…¬å¼æ˜¯:(å­˜è´§é€±è½‰å¤©æ•¸)+(æ‡‰æ”¶æ¬¾é€±è½‰å¤©æ•¸)-(æ‡‰ä»˜æ¬¾é€±è½‰å¤©æ•¸),ç›¡é‡ç°¡çŸ­å›è¦†",
    "åˆ©æ¯ä¿éšœå€æ•¸" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºåˆ©æ¯ä¿éšœå€æ•¸ï¼Œä»–çš„å…¬å¼æ˜¯:(ç¨…å‰æç›Š+åˆ©æ¯è²»ç”¨+æŠ˜èˆŠè²»ç”¨+æ”¤éŠ·è²»ç”¨)/åˆ©æ¯è²»ç”¨,ç›¡é‡ç°¡çŸ­å›è¦†",
    "éŠ·è²¨æˆé•·ç‡" => "è«‹å¹«æˆ‘è¨ˆç®—å‡ºéŠ·è²¨æˆé•·ç‡ï¼Œä»–çš„å…¬å¼æ˜¯:(æœ¬æœŸéŠ·è²¨/ä¸ŠæœŸéŠ·è²¨-1)*100,ç›¡é‡ç°¡çŸ­å›è¦†",
];

?>

<!DOCTYPE html>
<html class="no-js " lang="ZH_TW">

<head>
    <title>é æ¸¬</title>
    <link rel="icon" href="assets/font_icon/fonts/ahn4u-wrleu-001.ico" type="image/x-icon">

    <!-- meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/font_icon/css/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="assets/font_icon/css/helper.css">
    <link rel="stylesheet" href="assets/css/Financial.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.css">
    <link rel="stylesheet" href="assets/css/owl.theme.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/nav.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body id="body">
    <!-- Navigation area -->
    <section id="navigation">
        <div class="container">
            <div class="row">
                <div class="col-xs-2" style=" font-size: x-large; display: flex; ">
                    <a href="index.php">
                        <i><span class=" pe-7s-home in "></span>
                        </i>
                    </a>
                </div>
                <div class="col-xs-8">
                    <div class="content"><a data-scroll href="#body" class="logo-text" style="font-family:sans-serif; font-size: 30px;text-align: center; display: flex; flex-direction: initial;align-items: baseline; justify-content: center;">å¸‚å ´é¢¨éšª<br>è©•ä¼°ç³»çµ±</a>
                    </div>
                </div>
                <div class="col-xs-2">
                    <div class="nav">
                        <a href="#" data-placement="bottom" title="Menu" class="menu" data-toggle="dropdown"><i class="pe-7s-menu"></i></a>
                        <a href="#"></a>
                        <div class="dropdown-menu" style="background: #ffffff;">
                            <div class="arrow-up"></div>
                            <ul>
                                <a href="index.php">
                                    <li class="menu-item"><i data-scroll>ç›¸é—œæœå‹™</i><span class="menu-effect pe-7s-search" style="padding-left :85px;;font-size: 27px;"></span>
                                    </li>
                                </a>
                                <a href="index.php">
                                    <li class="menu-item"><i data-scroll>ç›¸é—œç¶²ç«™é€£çµ</i><span class="menu-effect pe-7s-link" style="font-size: 27px; padding-left: 48.5px;"></span>
                                    </li>
                                </a>
                                <a href="Risk_Assessment-search.php">
                                    <li class="menu-item"><i data-scroll>é¢¨éšªè©•ä¼°</i><span class="menu-effect pe-7s-search" style="font-size: 27px; padding-left: 85px;"></span>
                                    </li>
                                </a>
                                <a href="FinancialTest.php">
                                    <li class="menu-item"><i data-scroll>è²¡å‹™åˆ†æ</i><span class="menu-effect pe-7s-news-paper" style="font-size: 27px; padding-left: 85px;"></span>
                                    </li>
                                </a>
                                <a href="Contact_Us.php">
                                    <li class="menu-item"><i data-scroll>èˆ‡æˆ‘å€‘è¯ç¹«</i><span class="menu-effect pe-7s-call pe-dj pe-va" style="font-size: 27px; padding-left: 67px;"></span>
                                    </li>
                                </a>
                                <a href="carbon_rights.php">
                                    <li class="menu-item"><i data-scroll>ç¢³æ¬Šæ˜¯ä»€éº¼</i><span class="menu-effect fa fa-leaf pe-dj pe-va" style="font-size: 27px; padding-left: 64px;"></span>
                                    </li>
                                </a>
                                <a href="GP125.php">
                                    <li class="menu-item"><i data-scroll>ç¶ èƒ½æ˜¯ä»€éº¼</i><span class="menu-effect  pe-7s-light pe-dj pe-va" style="font-size: 27px; padding-left: 64px;"></span>
                                    </li>
                                </a>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- Content Area -->

    <!-- services section -->
    <section id="services" class="service-area">
        <div class="container" style=" display: flex; justify-content: center; align-items: start;flex-wrap: wrap;">
            <form id="form">
                <div class="row">
                    <h2 class="block_title">è«‹ä¸Šå‚³PDFæª”</h2>
                    <h3>è«‹ä¸Šå‚³è²¡å‹™å ±è¡¨</h3>
                    <h5>è«‹æ³¨æ„è‹¥æ˜¯æª”æ¡ˆå…§ç‚ºæƒææª”æœƒè®“AIç„¡æ³•åˆ¤è®€ï¼Œåœ¨ä½¿ç”¨äººå·¥æ™ºæ…§æŠ€è¡“æ™‚ï¼Œæ‡‰è¬¹æ…è€ƒæ…®å…¶æ½›åœ¨çš„éŒ¯èª¤åˆ¤æ–·é¢¨éšªã€‚è«‹ç´°å¿ƒä½¿ç”¨ï¼Œä¸¦å°ç”¢ç”Ÿçš„çµæœé€²è¡Œå¯©æ…è©•ä¼°ã€‚</h5>

                    <input type="file" class="form-control" name="pdf" id="pdf" style="margin: 9px 0px 0px 0px;">
                    <div id="upload-status" style="display: none;"></div>

                    <button class="btn btn-outline-secondary" type="button" onclick="uploadFile()" style="margin: 20px 0px 5px 0px; border: 3px solid #000;border-radius: 20px; color: #000;">é€å‡º</button>
                    <input type="text" class="form-control" name="message" id="message">
                    <button class="btn btn-outline-secondary" type="button" onclick="chat()" style="margin: 20px 0px 5px 0px;border: 3px solid #000;border-radius: 20px;color: #000;">ç™¼é€æ¶ˆæ¯</button>
                    <br>
                    <div id="chat-zone"></div>
                    <br>
                    <div class="snap">
                        <div class="quencard">
                            <h1 class="hh1">æˆ–è¨±ä½ æƒ³å•</h1>
                            <div class="cloum">
                                <?php
                                foreach ($terms as $term => $formula) {
                                    echo '<p onclick="fillInput(this)" class="Press" data-formula="' . htmlspecialchars($formula) . '">' . htmlspecialchars($term) . '</p>';
                                }
                                ?>
                                <p>&nbsp;</p>
                            </div>
                        </div>

                    </div>
            </form>
        </div>
    </section>

    <section id="portfolio" class="portfolio-area">
        <div class="container" style="display: flex;text-align: center;">
            <div class="row port cs-style-3">

            </div>
        </div>
    </section>

    <!-- Footer Area -->

    <!-- <footer>
        <div class="container">
            <div class="row">
                <div class="col-sm-6">
                    <p class="copyright">Â© æ¨¹å¾·ç§‘å¤§ ç‰ˆæ¬Šæ‰€æœ‰ <a href="#" target="_blank">Your Website Link</a></p>
                </div>
                <div class="col-sm-6">
                    <p class="designed">Theme by <a href="http://themewagon.com" target="_blank">Themewagon</a></p>
                </div>
            </div>
        </div>
    </footer> -->

    <!-- Necessery scripts -->
    <script src="assets/js/jquery-2.1.3.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.actual.min.js"></script>
    <script src="assets/js/smooth-scroll.js"></script>
    <script src="assets/js/owl.carousel.js"></script>
    <script src="assets/js/script.js"></script>
    <script src="assets/js/modernizr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        let vectorStoreId = null;

        // å„²å­˜é»æ“Šæç¤ºå­—å¡«å…¥å•é¡Œæ¬„
        function fillInput(elm) {
            document.getElementById('message').value = elm.dataset.formula;
        }

        async function uploadFile() {
            const fileInput = document.getElementById('pdf');
            const statusDiv = document.getElementById('upload-status');

            if (!fileInput.files.length) return Swal.fire('è«‹é¸æ“‡æª”æ¡ˆ', '', 'warning');

            const formData = new FormData();
            formData.append('pdf', fileInput.files[0]);

            statusDiv.style.display = 'none';

            // ğŸ”„ é¡¯ç¤ºä¸Šå‚³æç¤º
            Swal.fire({
                title: 'æ­£åœ¨ä¸Šå‚³æª”æ¡ˆ',
                text: 'è«‹ç¨å€™...',
                allowOutsideClick: false,
                didOpen: () => Swal.showLoading()
            });

            try {
                const response = await fetch('upload.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                console.log('ä¸Šå‚³å›æ‡‰:', data);
                Swal.close(); // é—œé–‰ loading

                if (data.status === 'uploaded') {
                    vectorStoreId = data.vector_id;
                    statusDiv.innerHTML = 'âœ… æª”æ¡ˆä¸Šå‚³æˆåŠŸï¼ŒAI å·²æº–å‚™å¥½ï¼';
                    statusDiv.style.display = 'block';
                    Swal.fire('ä¸Šå‚³æˆåŠŸ', 'AI å·²æº–å‚™å¥½è™•ç†ä½ çš„æå•', 'success');
                } else {
                    Swal.fire('ä¸Šå‚³å¤±æ•—', data.message, 'error');
                }
            } catch (err) {
                Swal.fire('ä¸Šå‚³éŒ¯èª¤', err.message, 'error');
            }
        }

        async function chat() {
            const msg = document.getElementById('message').value;
            const chatZone = document.getElementById('chat-zone');

            if (!vectorStoreId) return Swal.fire('è«‹å…ˆä¸Šå‚³ PDF æª”æ¡ˆ', '', 'warning');
            if (!msg.trim()) return Swal.fire('è«‹è¼¸å…¥å•é¡Œ', '', 'warning');

            chatZone.innerHTML = '';

            // ğŸ”„ é¡¯ç¤º AI æ­£åœ¨æ€è€ƒ
            Swal.fire({
                title: 'AI å›è¦†ä¸­',
                text: 'è«‹ç¨å€™...',
                allowOutsideClick: false,
                didOpen: () => Swal.showLoading()
            });

            try {
                const response = await fetch('ask.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        question: msg,
                        vector_id: vectorStoreId
                    })
                });

                const data = await response.json();
                Swal.close(); // é—œé–‰ loading

                if (data.status === 'answered') {
                    chatZone.innerHTML = `<div class="alert alert-success"><strong>AI å›è¦†ï¼š</strong><br>${data.reply}</div>`;
                } else {
                    Swal.fire('å›è¦†å¤±æ•—', data.message, 'error');
                }
            } catch (err) {
                Swal.close();
                Swal.fire('ç™¼ç”ŸéŒ¯èª¤', err.message, 'error');
            }
        }
    </script>

</body>

</html>